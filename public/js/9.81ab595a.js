(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[9],{"2cca":function(t,e,o){},b3fd:function(t,e,o){"use strict";o.r(e);var i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[t.loading?o("div",{staticClass:"text-center align-circular-progress-indicator"},[o("q-circular-progress",{staticClass:"q-ma-md ",attrs:{indeterminate:"",size:"50px",color:"blue"}})],1):o("div",[o("q-table",{attrs:{grid:"",title:"Minhas notas","row-key":"id","hide-header":"","rows-per-page-label":"Itens por página","no-data-label":"Nenhuma nota salva",data:t.data,columns:t.columns},on:{"row-click":t.noteClick},scopedSlots:t._u([{key:"top-right",fn:function(){return[o("q-input",{attrs:{borderless:"",dense:"",debounce:"300",placeholder:"Buscar"},scopedSlots:t._u([{key:"append",fn:function(){return[o("q-icon",{attrs:{name:"search"}})]},proxy:!0}]),model:{value:t.filterKey,callback:function(e){t.filterKey=e},expression:"filterKey"}})]},proxy:!0}])}),o("q-dialog",{attrs:{persistent:""},model:{value:t.openModal,callback:function(e){t.openModal=e},expression:"openModal"}},[o("q-card",{staticStyle:{width:"700px","max-width":"80vw"}},[o("q-form",{on:{submit:function(e){t.selectedNoteId?t.putNotation():t.postNotation()}}},[o("q-card-section",{staticClass:"row"},[o("div",{staticClass:"width"},[o("q-input",{staticClass:"q-pb-lg",attrs:{label:"Titulo da nota",rules:[function(t){return 0!=t.length&&t.length<=60||"Titulo inválido"}]},model:{value:t.selectedNoteTitle,callback:function(e){t.selectedNoteTitle=e},expression:"selectedNoteTitle"}}),o("q-input",{attrs:{filled:"",autogrow:"",label:"Nota",rules:[function(t){return 0!=t.length||"Nota inválida"}]},model:{value:t.selectedNoteBody,callback:function(e){t.selectedNoteBody=e},expression:"selectedNoteBody"}})],1)]),o("q-card-actions",{attrs:{align:"right"}},[t.selectedNoteId?o("q-btn",{attrs:{flat:"",label:"Deletar",color:"red"},on:{click:t.deleteNote}}):t._e(),o("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancelar",color:"primary"}}),o("q-btn",{attrs:{flat:"",label:"Salvar",type:"submit",color:"primary"}})],1)],1)],1)],1),o("q-page-sticky",{attrs:{position:"bottom-right",offset:[18,18]}},[o("q-btn",{attrs:{fab:"",icon:"add",color:"blue"},on:{click:t.noteClick}})],1)],1)])},a=[],s=o("60a3"),n=function(t,e,o,i){var a,s=arguments.length,n=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)n=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(n=(s<3?a(n):s>3?a(e,o,n):a(e,o))||n);return s>3&&n&&Object.defineProperty(e,o,n),n},r=function(t,e,o,i){function a(t){return t instanceof o?t:new o((function(e){e(t)}))}return new(o||(o=Promise))((function(o,s){function n(t){try{l(i.next(t))}catch(e){s(e)}}function r(t){try{l(i["throw"](t))}catch(e){s(e)}}function l(t){t.done?o(t.value):a(t.value).then(n,r)}l((i=i.apply(t,e||[])).next())}))};let l=class extends s["c"]{constructor(){super(...arguments),this.data=[],this.dataOriginal=[],this.filterKey="",this.openModal=!1,this.loading=!0,this.selectedNoteTitle="",this.selectedNoteId="",this.selectedNoteBody="",this.columns=[{field:t=>`${t.title}`},{field:t=>`${this.dateFormatter(t.created_at)}`}]}noteClick(t,e){this.selectedNoteTitle=e.title||"",this.selectedNoteBody=e.body||"",this.selectedNoteId=e.id||"",this.openModal=!0}created(){this.isAuthenticate(),this.getme().then((()=>{this.getNotation().then((()=>{this.loading=!1}))}))}deleteNote(){return r(this,void 0,void 0,(function*(){try{yield this.$axios.delete("/notation/",{data:{id:this.selectedNoteId}}),yield this.getNotation(),this.openModal=!1,this.$q.notify({message:"Nota deletada",color:"green"})}catch(t){try{this.$q.notify({message:t.response.data.message,color:"red-5"})}catch(e){this.$q.notify({message:"Ops, algo deu errado",color:"red-5"})}}}))}getNotation(){return r(this,void 0,void 0,(function*(){try{const t=yield this.$axios.get("/notation");this.dataOriginal=t.data.notations,this.data=this.dataOriginal}catch(t){try{this.$q.notify({message:t.response.data.message,color:"red-5"})}catch(e){this.$q.notify({message:"Ops, algo deu errado",color:"red-5"})}}}))}filter(){this.data=[...this.dataOriginal.filter((t=>t.title.toLowerCase().includes(this.filterKey.toLowerCase())||t.body.toLowerCase().includes(this.filterKey.toLowerCase())))]}getme(){return r(this,void 0,void 0,(function*(){try{this.$axios.defaults.headers={Authorization:`Bearer ${localStorage.getItem("token")||""}`};const t=yield this.$axios.get("/user/me"),e=t.data;yield localStorage.setItem("user",JSON.stringify(e))}catch(t){401==t.response.status&&(localStorage.clear(),this.$router.push({name:"home"}))}}))}dateFormatter(t){const e=new Date(t);return e.toLocaleDateString()}putNotation(){return r(this,void 0,void 0,(function*(){try{const t=yield this.$axios.put("/notation",{id:this.selectedNoteId,title:this.selectedNoteTitle,body:this.selectedNoteBody});this.$q.notify({message:t.data.message,color:"green"}),yield this.getNotation(),this.openModal=!1}catch(t){try{this.$q.notify({message:t.response.data.message,color:"red-5"})}catch(e){this.$q.notify({message:"Ops. algo deu errado",color:"red-5"})}}}))}postNotation(){return r(this,void 0,void 0,(function*(){try{const t=yield this.$axios.post("/notation",{title:this.selectedNoteTitle,body:this.selectedNoteBody});yield this.getNotation(),this.$q.notify({message:t.data.message,color:"green"}),this.openModal=!1}catch(t){try{this.$q.notify({message:t.response.data.message,color:"red-5"})}catch(e){this.$q.notify({message:"Ops. algo deu errado",color:"red-5"})}}}))}isAuthenticate(){return r(this,void 0,void 0,(function*(){let t;const e=(yield localStorage.getItem("user"))||"";try{t=JSON.parse(e)}catch(o){this.$router.push({name:"home"})}}))}};n([Object(s["d"])("filterKey")],l.prototype,"filter",null),l=n([s["a"]],l);var c=l,d=c,h=(o("d872"),o("2877")),u=Object(h["a"])(d,i,a,!1,null,"65462458",null);e["default"]=u.exports},d872:function(t,e,o){"use strict";o("2cca")}}]);